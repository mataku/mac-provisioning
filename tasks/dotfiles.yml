---

- name: git clone my dotfiles
  git:
    repo=https://github.com/rhythnn/dotfiles.git
    dest=~/dotfiles
    version=master

- name: git clone zplug
  git:
    repo=https://github.com/b4b4r07/zplug
    dest=~/.zplug
    version=master

- name: install oh-my-zsh
  shell: curl -L https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh | sh
  args:
    creates: ~/

- name: mkdir vim dir
  file: path=~/.vim state=directory mode=0755

- name: mkdir nvim dir
  file: path=~/.config state=directory mode=0755


- name: create dotfile symlinks
  file:
    src: ~/dotfiles/{{ item }}
    dest: ~/{{ item }}
    state: link
    force: yes

  with_items:
    - .zshrc
    - .vimrc


- name: create symlinks of vim
  file:
    src: ~/dotfiles/vim/{{ item }}
    dest: ~/.vim/{{ item }}
    state: link
    force: yes

  with_items:
    - after
    - autoload
    #- bundle
    - colors
    - dein
    - indent
    - rc

- name: create symlinks of neovim
  file:
    src: ~/dotfiles/nvim
    dest: ~/.config
    state: link
    force: yes

- name: change login shell
  shell: >
    chpass -s {{which_zsh.stdout}}
  register: result
  until: result.rc == 0
  retries: 3
